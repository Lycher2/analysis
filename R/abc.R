#' abc for R
#'
#' @param a quadratic coefficient
#' @param b linear coefficient
#' @param c constant
#' @return root
#' @export
abc <- function(a){
  cat(" 1) –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        E(X)
        F - —Å—Ç–æ–ª–±–µ—Ü –¥–∞–Ω–Ω—ã—Ö
       19. x—Å—Ä	–°–†–ó–ù–ê–ß(F:F)
       20. s	–°–¢–ê–ù–î–û–¢–ö–õ–û–ù.–í(F:F)
       21. n	–°–ß–Å–¢(F:F)
       22. t	–°–¢–¨–Æ–î–ï–ù–¢.–û–ë–†(1-I23/2;I21-1)
       23. –∞–ª—å—Ñ–∞	1-I24
       24. –≥–∞–º–º–∞	0,95
       25. –¥–µ–ª—å—Ç–∞	I20*I22/–ö–û–†–ï–ù–¨(I21)
       26. –≥—Ä–∞–Ω–∏—Ü—ã –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞	
       27. E(X1)	I19-I25
       28. E(X2)	I19+I25

       Var(X)	
       33. n	–°–ß–Å–¢(F:F)
       34. s^2	–î–ò–°–ü.–í(F:F)
       35. x–∏2 –ª–µ–≤	–•–ò2.–û–ë–†(I37/2;I33-1)
       36. —Ö–∏2 –ø—Ä–∞–≤	–•–ò2.–û–ë–†(1-I37/2;I33-1)
       37. –∞–ª—å—Ñ–∞	1-I38
       38. –≥–∞–º–º–∞	0,95
       39. –≥—Ä–∞–Ω–∏—Ü—ã –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞	
       40. Var(X1)	(I33-1)*I34/I36
       41. Var(X2)	(I33-1)*I34/I35
       42. s(X1)	–ö–û–†–ï–ù–¨(I40)
       43. s(X2)	–ö–û–†–ï–ù–¨(I41)

      –¢–µ—Å—Ç 1
      –ù0: r=0	—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–∑–Ω–∞—á–∏–º
      H1: r–Ω–µ=0	—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º
      PV < 0,005 => –ù0 –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –∫–æ—ç—Ñ –∫–æ—Ä—Ä–µ–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º
      –¥–ª—è 3 –∫–æ–º–ø–∞–Ω–∏–π –ø–æ —Å—Ç–æ–ª–±—Ü—É –ª–æ–≥–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
      cor.test(X$V1, Y$V1) 
      cor.test(X$V1, Y$V1)$p.value
      cor.test(X$V1, Y$V1)$p.value<0.005

      –¢–µ—Å—Ç 2
      ùêª0:ùê∏(ùëãùëñ)=0		–∞–ª—å—Ñ–∞=0,05
      ùêª1:ùê∏(ùëãùëñ)‚â†0
      t.test(X$V1, mu=0)  $p.value   	
      t.test(X$V1, mu=0)  $p.value <0.05 
      –±–æ–ª—å—à–µ –∞–ª—å—Ñ–∞	–Ω–µ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è
      –º–µ–Ω—å—à–µ –∞–ª—å—Ñ–∞	–æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è

      –¢–µ—Å—Ç 3
      ùêª0:ùê∏(ùëãùëñ)=ùê∏(ùëãùëó)		
      ùêª1:ùê∏(ùëãùëñ)‚â†ùê∏(ùëãùëó)H1:E(Xi)‚â†E(Xj)¬†		
      –∞–ª—å—Ñ–∞=0,05
      t.test(X$V1, Y$V1)$p.value 		
      t.test(X$V1, Y$V1)$p.value <0.05 		

      –¢–µ—Å—Ç 4
      –ù0: Var(X)=Var(Y)	
      H1: Var(X)–Ω–µ=Var(Y)	
      –∞–ª—å—Ñ–∞=0,05	
      var.test(X$V1, Y$V1)$p.value 		
      var.test(X$V1, Y$V1)$p.value <0.05 		

      –¢–µ—Å—Ç 5
      lillie.test(X$V1) 		
      lillie.test(X$V1)$p.value 		
      lillie.test(X$V1)$p.value < 0.001 		

    #gde ' tam dve '
    # source('Ci.R')      # –ü–æ–¥–∫–ª—é—á–∞–µ–º —Ñ–∞–π–ª Ci.R –¥–∞–Ω–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π 
      #-------------------------------------------------------------------------------------
      # –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
      # ciE(Rez,0.95)       # –í—ã—á–∏—Å–ª—è–µ—Ç –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è E –ø–æ –≤—ã–±–æ—Ä–∫–µ Rez
      # ciD(Rez,0.95)       # –í—ã—á–∏—Å–ª—è–µ—Ç –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è D –ø–æ –≤—ã–±–æ—Ä–∫–µ Rez
      
      ciE <- function(X, Gamma) {
        n <- length(X)
        ciE <- mean(X, na.rm = TRUE)-sd(X, na.rm = TRUE)/sqrt(n)*qt((1+c(Gamma,0,-Gamma))/2,n-1)
        Interval <- cbind(E.Left = ciE[1],E.Right = ciE[3])
        Res <- list(Eo = ciE[2], Interval = Interval)
        return(Res)
      }
      #--------------------------
      # –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏ (–∏–ª–∏ –¥–ª—è –∏—Å—Ç–∏–Ω–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏) –ø–æ –≤—ã–±–æ—Ä–∫–µ
      ciD <- function(X, Gamma) {
        n <- length(X)
        ciD <- sd(X, na.rm = TRUE)^2*(n-1)/qchisq((1+c(Gamma,0,-Gamma))/2,n-1)
        Interval <- cbind(D.Left = ciD[1], D.Right = ciD[3])
        Res <- list(Do = var(X), Interval = Interval)
        return(Res)
      }
      #-----------------------------------------------------------------------------------------
      # –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π –¥–æ–ª–∏ (–∏–ª–∏ –¥–ª—è –∏—Å—Ç–∏–Ω–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏) –ø–æ –≤—ã–±–æ—Ä–∫–µ
      ciP <- function(k,n,N,Gamma) {
        if (N == Inf) {ciP <- k/n-sqrt(k/n*(1-k/n)/n)*qnorm((1+c(Gamma,0,-Gamma))/2)} 
        else  {ciP <- k/n-sqrt(k/n*(1-k/n)/n)*sqrt(1-n/N)*qnorm((1+c(Gamma,0,-Gamma))/2)}
        Interval <- cbind(P.Left = max(0,ciP[1]), P.Right = min(1,ciP[3]))
        Res <- list(Po = ciP[2], Interval = Interval)
        return(Res)
      }
      ciP(10,21,Inf,0.95)  # –î–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏
      ciP(10,21,100,0.95)  # –î–ª—è –±–µ—Å–ø–æ–≤—Ç–æ—Ä–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –æ–±—ä–µ–º–∞ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏
      #-------------------------------------------------------------------------------------
      # –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Å.–≤. X —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ –∑–∞–¥–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ f(x) –Ω–∞ [a, b], –≤–∫–ª—é—á–∞—è b = inf.
      # –í–ê–ñ–ù–û! –ù–µ–æ–±—Ö–æ–¥–∏–º–∞—è –§—É–Ω–∫—Ü–∏—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ f <- function(x) {x*exp(-x)} –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∞ –∑–∞—Ä–∞–Ω–µ–µ
      
      # is.fun(f, a = 0, b = Inf)        # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–æ—Ä–º–∏—Ä–æ–≤–∫—É —Ñ—É–Ω–∫—Ü–∏–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ f 
      # rfun(n = 300, f, a = 0, b = 4)   # –ù–∞–±–ª—é–¥–µ–Ω–∏—è n —Ä–∞–∑ —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã X ~ f(x), –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ [a, b]
      # pfun(q = 2, f, a = 0, b = 3)     # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å P[X ‚â§ q] –¥–ª—è X ~ f(x), –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ [a, b]
      # dfun(x = 3, f, a = -5, b = Inf)  # –ü–ª–æ—Ç–Ω–æ—Å—Ç—å f(x) –¥–ª—è X ~ f(x), –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ [a, b]
      # qfun(p = 0.5, f, a = 4, b = 100) # –ö–≤–∞–Ω—Ç–∏–ª—å —É—Ä–æ–≤–Ω—è p –¥–ª—è X ~ f(x), –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ [a, b]
      
      #--------------------------
      # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏–µ –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ f –Ω–∞ –æ–±–ª–∞—Å—Ç–∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ [a, b] 
      
      is.fun <- function(f, a, b) {
        if (abs(integrate(f,a,b)$value - 1) > 10^(-8)) {return(paste(integrate(f,a,b)$value,' Opps...! f is not density!'))}
        else { return('OK!')}
      }
      
      #--------------------------
      # –†–∞–∑—ã–≥—Ä—ã–≤–∞–µ—Ç n —Ä–∞–∑ —Å–ª—É—á–∞–π–Ω—É—é –≤–µ–ª–∏—á–∏–Ω—É X c –ø–ª–æ—Ç–Ω–æ—Å—Ç—å—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ f, –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –Ω–∞ [a, b]
      # P.S. –ü–∞—Ä–∞–º–µ—Ç—Ä step - —à–∞–≥ –ø–æ x –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.01
      
      rfun <- function(n, f, a, b, step = 0.01) {
        X <- rep(a, n) # –ù–∞–∑–Ω–∞—á–∞–µ–º X –≤ –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–≥–æ i-–≥–æ –æ–ø—ã—Ç–∞ –∏–∑ n —Å–∞–º–æ–º—É –ª–µ–≤–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é: a
        Y <- runif(n)    # n —Ä–∞–∑ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—É—é —Å.–≤. Y –Ω–∞ (0,1)
        for (i in 1:n) {
          I <- 0
          while(I < Y[i]) { # –≠—Ç–æ—Ç —Ü–∏–∫–ª —Ä–µ—à–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ X –ø–æ Y
            X[i] <- X[i] + step
            I <- integrate(f, a, X[i])$value
          }
          X[i] <- X[i] - step
        }
        return(X)
      }
      
      #--------------------------
      # –í—ã—á–∏—Å–ª—è–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å P(X ‚â§ q) –¥–ª—è X ~ f(x), –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ [a, b].
      
      pfun <- function(q, f, a, b) {
        if (q < a) {return(0)} else 
          if (q > b) {return(1)} else {
            P <- sapply(q, function(q) {integrate(f, a, q)$value})
            return(P) 
          }
      }
      
      #--------------------------
      # –í—ã—á–∏—Å–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ f –≤ —Ç–æ—á–∫–µ x –¥–ª—è X ~ f(x), –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ [a, b] .
      
      dfun <- function(x, f, a, b) {
        return(f(x)) 
      }  
      
      #--------------------------
      # –í—ã—á–∏—Å–ª—è–µ—Ç –∫–≤–∞–Ω—Ç–∏–ª—å —É—Ä–æ–≤–Ω—è p –¥–ª—è X ~ f(x), –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ [a, b] .
      # P.S. –ü–∞—Ä–∞–º–µ—Ç—Ä step - —à–∞–≥ –ø–æ x –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.001
      
      qfun <- function(p, f, a, b, step = 0.01) {
        q <- a
        I <- 0
        while(I < p) { # –≠—Ç–æ—Ç —Ü–∏–∫–ª —Ä–µ—à–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ
          q <- q + step
          I <- integrate(f, a, q)$value
        }
        return(q - step) 
      }
      #---------–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ –¥–æ–ª–µ–π--------------------
      EqP <- function(k1, k2, n1, n2) {
        p1 <- k1/n1; p2 <- k2/n2; p <- (k1+k2)/(n1+n2)
        Z <- (p1-p2-0.5/(n1+n2))/(p*(1-p)*(1/n1+1/n2))^0.5
        #  by(X, Y, mean)
        Res <- paste('Pvalue = ', round(2*(1-pnorm(abs(Z))), 5))
        return(Res)
      })
  }")
}
