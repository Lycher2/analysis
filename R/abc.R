#' abc for R
#'
#' @param a quadratic coefficient
#' @param b linear coefficient
#' @param c constant
#' @return root
#' @export
abc <- function(a){
  cat(" 1) –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        E(X)
        F - —Å—Ç–æ–ª–±–µ—Ü –¥–∞–Ω–Ω—ã—Ö
       19. x—Å—Ä	–°–†–ó–ù–ê–ß(F:F)
       20. s	–°–¢–ê–ù–î–û–¢–ö–õ–û–ù.–í(F:F)
       21. n	–°–ß–Å–¢(F:F)
       22. t	–°–¢–¨–Æ–î–ï–ù–¢.–û–ë–†(1-I23/2;I21-1)
       23. –∞–ª—å—Ñ–∞	1-I24
       24. –≥–∞–º–º–∞	0,95
       25. –¥–µ–ª—å—Ç–∞	I20*I22/–ö–û–†–ï–ù–¨(I21)
       26. –≥—Ä–∞–Ω–∏—Ü—ã –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞	
       27. E(X1)	I19-I25
       28. E(X2)	I19+I25

       Var(X)	
       33. n	–°–ß–Å–¢(F:F)
       34. s^2	–î–ò–°–ü.–í(F:F)
       35. x–∏2 –ª–µ–≤	–•–ò2.–û–ë–†(I37/2;I33-1)
       36. —Ö–∏2 –ø—Ä–∞–≤	–•–ò2.–û–ë–†(1-I37/2;I33-1)
       37. –∞–ª—å—Ñ–∞	1-I38
       38. –≥–∞–º–º–∞	0,95
       39. –≥—Ä–∞–Ω–∏—Ü—ã –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞	
       40. Var(X1)	(I33-1)*I34/I36
       41. Var(X2)	(I33-1)*I34/I35
       42. s(X1)	–ö–û–†–ï–ù–¨(I40)
       43. s(X2)	–ö–û–†–ï–ù–¨(I41)

      –¢–µ—Å—Ç 1
      –ù0: r=0	—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–∑–Ω–∞—á–∏–º
      H1: r–Ω–µ=0	—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º
      PV < 0,005 => –ù0 –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –∫–æ—ç—Ñ –∫–æ—Ä—Ä–µ–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º
      –¥–ª—è 3 –∫–æ–º–ø–∞–Ω–∏–π –ø–æ —Å—Ç–æ–ª–±—Ü—É –ª–æ–≥–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
      cor.test(X$V1, Y$V1) 
      cor.test(X$V1, Y$V1)$p.value
      cor.test(X$V1, Y$V1)$p.value<0.005

      –¢–µ—Å—Ç 2
      ùêª0:ùê∏(ùëãùëñ)=0		–∞–ª—å—Ñ–∞=0,05
      ùêª1:ùê∏(ùëãùëñ)‚â†0
      t.test(X$V1, mu=0)  $p.value   	
      t.test(X$V1, mu=0)  $p.value <0.05 
      –±–æ–ª—å—à–µ –∞–ª—å—Ñ–∞	–Ω–µ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è
      –º–µ–Ω—å—à–µ –∞–ª—å—Ñ–∞	–æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è

      –¢–µ—Å—Ç 3
      ùêª0:ùê∏(ùëãùëñ)=ùê∏(ùëãùëó)		
      ùêª1:ùê∏(ùëãùëñ)‚â†ùê∏(ùëãùëó)		
      –∞–ª—å—Ñ–∞=0,05
      t.test(X$V1, Y$V1)$p.value 		
      t.test(X$V1, Y$V1)$p.value <0.05 		

      –¢–µ—Å—Ç 4
      –ù0: Var(X)=Var(Y)	
      H1: Var(X)–Ω–µ=Var(Y)	
      –∞–ª—å—Ñ–∞=0,05	
      var.test(X$V1, Y$V1)$p.value 		
      var.test(X$V1, Y$V1)$p.value <0.05 		

      –¢–µ—Å—Ç 5
      lillie.test(X$V1) 		
      lillie.test(X$V1)$p.value 		
      lillie.test(X$V1)$p.value < 0.001 		

    #gde ' tam dve '
    # source('Ci.R')      # –ü–æ–¥–∫–ª—é—á–∞–µ–º —Ñ–∞–π–ª Ci.R –¥–∞–Ω–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π 
      #-------------------------------------------------------------------------------------
      # –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
      # ciE(Rez,0.95)       # –í—ã—á–∏—Å–ª—è–µ—Ç –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è E –ø–æ –≤—ã–±–æ—Ä–∫–µ Rez
      # ciD(Rez,0.95)       # –í—ã—á–∏—Å–ª—è–µ—Ç –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è D –ø–æ –≤—ã–±–æ—Ä–∫–µ Rez
      
      ciE <- function(X, Gamma) {
        n <- length(X)
        ciE <- mean(X, na.rm = TRUE)-sd(X, na.rm = TRUE)/sqrt(n)*qt((1+c(Gamma,0,-Gamma))/2,n-1)
        Interval <- cbind(E.Left = ciE[1],E.Right = ciE[3])
        Res <- list(Eo = ciE[2], Interval = Interval)
        return(Res)
      }
      #--------------------------
      # –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏ (–∏–ª–∏ –¥–ª—è –∏—Å—Ç–∏–Ω–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏) –ø–æ –≤—ã–±–æ—Ä–∫–µ
      ciD <- function(X, Gamma) {
        n <- length(X)
        ciD <- sd(X, na.rm = TRUE)^2*(n-1)/qchisq((1+c(Gamma,0,-Gamma))/2,n-1)
        Interval <- cbind(D.Left = ciD[1], D.Right = ciD[3])
        Res <- list(Do = var(X), Interval = Interval)
        return(Res)
      }
      #-----------------------------------------------------------------------------------------
      # –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π –¥–æ–ª–∏ (–∏–ª–∏ –¥–ª—è –∏—Å—Ç–∏–Ω–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏) –ø–æ –≤—ã–±–æ—Ä–∫–µ
      ciP <- function(k,n,N,Gamma) {
        if (N == Inf) {ciP <- k/n-sqrt(k/n*(1-k/n)/n)*qnorm((1+c(Gamma,0,-Gamma))/2)} 
        else  {ciP <- k/n-sqrt(k/n*(1-k/n)/n)*sqrt(1-n/N)*qnorm((1+c(Gamma,0,-Gamma))/2)}
        Interval <- cbind(P.Left = max(0,ciP[1]), P.Right = min(1,ciP[3]))
        Res <- list(Po = ciP[2], Interval = Interval)
        return(Res)
      }
      ciP(10,21,Inf,0.95)  # –î–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏
      ciP(10,21,100,0.95)  # –î–ª—è –±–µ—Å–ø–æ–≤—Ç–æ—Ä–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –æ–±—ä–µ–º–∞ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏
      #-------------------------------------------------------------------------------------
      # –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞—è —Å.–≤. X —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ –∑–∞–¥–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ f(x) –Ω–∞ [a, b], –≤–∫–ª—é—á–∞—è b = inf.
      # –í–ê–ñ–ù–û! –ù–µ–æ–±—Ö–æ–¥–∏–º–∞—è –§—É–Ω–∫—Ü–∏—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ f <- function(x) {x*exp(-x)} –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∞ –∑–∞—Ä–∞–Ω–µ–µ
      
      # is.fun(f, a = 0, b = Inf)        # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–æ—Ä–º–∏—Ä–æ–≤–∫—É —Ñ—É–Ω–∫—Ü–∏–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ f 
      # rfun(n = 300, f, a = 0, b = 4)   # –ù–∞–±–ª—é–¥–µ–Ω–∏—è n —Ä–∞–∑ —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã X ~ f(x), –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ [a, b]
      # pfun(q = 2, f, a = 0, b = 3)     # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å P[X ‚â§ q] –¥–ª—è X ~ f(x), –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ [a, b]
      # dfun(x = 3, f, a = -5, b = Inf)  # –ü–ª–æ—Ç–Ω–æ—Å—Ç—å f(x) –¥–ª—è X ~ f(x), –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ [a, b]
      # qfun(p = 0.5, f, a = 4, b = 100) # –ö–≤–∞–Ω—Ç–∏–ª—å —É—Ä–æ–≤–Ω—è p –¥–ª—è X ~ f(x), –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ [a, b]
      
      #--------------------------
      # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏–µ –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ f –Ω–∞ –æ–±–ª–∞—Å—Ç–∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ [a, b] 
      
      is.fun <- function(f, a, b) {
        if (abs(integrate(f,a,b)$value - 1) > 10^(-8)) {return(paste(integrate(f,a,b)$value,' Opps...! f is not density!'))}
        else { return('OK!')}
      }
      
      #--------------------------
      # –†–∞–∑—ã–≥—Ä—ã–≤–∞–µ—Ç n —Ä–∞–∑ —Å–ª—É—á–∞–π–Ω—É—é –≤–µ–ª–∏—á–∏–Ω—É X c –ø–ª–æ—Ç–Ω–æ—Å—Ç—å—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ f, –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –Ω–∞ [a, b]
      # P.S. –ü–∞—Ä–∞–º–µ—Ç—Ä step - —à–∞–≥ –ø–æ x –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.01
      
      rfun <- function(n, f, a, b, step = 0.01) {
        X <- rep(a, n) # –ù–∞–∑–Ω–∞—á–∞–µ–º X –≤ –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–≥–æ i-–≥–æ –æ–ø—ã—Ç–∞ –∏–∑ n —Å–∞–º–æ–º—É –ª–µ–≤–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é: a
        Y <- runif(n)    # n —Ä–∞–∑ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—É—é —Å.–≤. Y –Ω–∞ (0,1)
        for (i in 1:n) {
          I <- 0
          while(I < Y[i]) { # –≠—Ç–æ—Ç —Ü–∏–∫–ª —Ä–µ—à–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ X –ø–æ Y
            X[i] <- X[i] + step
            I <- integrate(f, a, X[i])$value
          }
          X[i] <- X[i] - step
        }
        return(X)
      }
      
      #--------------------------
      # –í—ã—á–∏—Å–ª—è–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å P(X ‚â§ q) –¥–ª—è X ~ f(x), –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ [a, b].
      
      pfun <- function(q, f, a, b) {
        if (q < a) {return(0)} else 
          if (q > b) {return(1)} else {
            P <- sapply(q, function(q) {integrate(f, a, q)$value})
            return(P) 
          }
      }
      
      #--------------------------
      # –í—ã—á–∏—Å–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ f –≤ —Ç–æ—á–∫–µ x –¥–ª—è X ~ f(x), –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ [a, b] .
      
      dfun <- function(x, f, a, b) {
        return(f(x)) 
      }  
      
      #--------------------------
      # –í—ã—á–∏—Å–ª—è–µ—Ç –∫–≤–∞–Ω—Ç–∏–ª—å —É—Ä–æ–≤–Ω—è p –¥–ª—è X ~ f(x), –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ [a, b] .
      # P.S. –ü–∞—Ä–∞–º–µ—Ç—Ä step - —à–∞–≥ –ø–æ x –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.001
      
      qfun <- function(p, f, a, b, step = 0.01) {
        q <- a
        I <- 0
        while(I < p) { # –≠—Ç–æ—Ç —Ü–∏–∫–ª —Ä–µ—à–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ
          q <- q + step
          I <- integrate(f, a, q)$value
        }
        return(q - step) 
      }
      #---------–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ –¥–æ–ª–µ–π--------------------
      EqP <- function(k1, k2, n1, n2) {
        p1 <- k1/n1; p2 <- k2/n2; p <- (k1+k2)/(n1+n2)
        Z <- (p1-p2-0.5/(n1+n2))/(p*(1-p)*(1/n1+1/n2))^0.5
        #  by(X, Y, mean)
        Res <- paste('Pvalue = ', round(2*(1-pnorm(abs(Z))), 5))
        return(Res)
      })
  }
  library(psych)
  library(e1071)
  data <- c(1.46, -0.62, -0.21, -0.71, 0.11, -0.24, 0.37, 0.44, -0.64, -0.77, -0.06, 0.03, 0.25, 0.44, -1.07, 0.49, 0.4, -0.44, 0.02, 0.31, 0.67, 1.22, -1.12, 1.56, 0.9, -0.8, 0.04, 0.92, -0.47, -0.54, -1.68, 0.3, 0.94, 0.9, -0.24, -1.02, 1.22, -0.31, 1.14, -0.9, -0.21, 0.98, -1.07, 0.12, -2.18, -0.63, -0.66, 0.05, 0.34, 0.03, -0.1, 0.15, -0.34, -1.36, 0.31, 0.99, -0.65, -0.52, -0.12, -0.44, 0.21, 0.33, 0.78, -0.55, -1.04, -1.02, -2.29, 0.14, -0.84, 1.65, 1.82, 0.16, 1.27, 1.42, -0.8, -0.31, 0.26, -0.32, -1.2, -1.34, 1.13, -0.66, 1.37, -2.03, -0.22, 1.72, 0.05, -0.01, -0.08, 2.21, 0.52, 1.41, 0.83, -0.76, -0.86, -0.77, -0.14, -1.4, 0.3, -0.81, 0.03, 1.27, -0.25, 0.21, -0.32, -2.11, -0.42, -0.66, -1.17, -0.79, -0.51, -2.18, -0.69, 0.35, -0.74, 0.23, -1.1, 0.09, 0.89, 0.11, 0.06, -0.1, -0.29, 0.75, -0.6, 0.71, 0.91, -1.18, -0.38, -0.49, -0.21, -0.49, 0.67, 0.4, -0.68, -1.57, 2.44, -0.71, 1.11, 0.24, -0.76, -1.09, -0.49, 0.52, 0.94, 0.49, 0.86, -0.09, -0.97, -0.37, 0.6, -2.64, -0.4, -1.42, -0.91, 0.36, -0.48, 0.22, 0.52, 1.46, -0.21, 2.52, 3.06, -1.29, 0.51, -1.31, -1.05, -0.79, 2.3, -2.08, -0.85, -1.4, -0.91, -0.58, -0.27, 0.4, 0.3, 1.22, 0.23, 0.47, 0.75, -0.12, -1.02, -1.52, 0.47, -1.36, 0.12, -0.1, 0.19, -0.23, -0.75, -2.36, -1.2, -2.08, 0.22, 0.33, 0.07, 1.05, 0.61, 0.2, -1.67)
  length(data)
  summary(data)
  describe(data)
  IQR(data) # –ú–µ–∂–∫–≤–∞—Ä—Ç–∏–ª—å–Ω—ã–π —Ä–∞–∑–º–∞—Ö
  quantile(data, probs = 0.38) # –ö–≤–∞–Ω—Ç–∏–ª—å —É—Ä–æ–≤–Ω—è
  var(data, y = NULL, na.rm = FALSE) #–î–∏—Å–ø–µ—Ä—Å–∏—è –≤—ã–±–æ—Ä–∫–∏ (–Ω–µ—Å–º–µ—â–µ–Ω–Ω–∞—è)
  skew(data)#	–ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ—Å—Ç—å (–Ω–µ—Å–º–µ—â–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞)
  kurtosi(data)#	–≠–∫—Å—Ü–µ—Å—Å (–Ω–µ—Å–º–µ—â–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞)
  psych::describe(data)
  IQR <- IQR(data)
  Q1 <- quantile(data, .25)#	–ù–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ –Ω–æ—Ä–º—ã
  lower_b <- Q1 - 1.5*IQR
  lower_b
  #—Å–ø—Ä–æ—Å–∏—Ç—å
  Q3 <- quantile(data, .75)#–í–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ –Ω–æ—Ä–º—ã
  upper_b <- Q3 + 1.5*IQR
  upper_b
  extra <- data[data<lower_b | data > upper_b]
  extra
  no_outliers <- subset(data, data> (Q1 - 1.5*IQR) & data< (Q3 + 1.5*IQR))
  length(data) - length(no_outliers)
  #1.2
  var(no_outliers, y = NULL, na.rm = FALSE) #–î–∏—Å–ø–µ—Ä—Å–∏—è –≤—ã–±–æ—Ä–∫–∏ (–Ω–µ—Å–º–µ—â–µ–Ω–Ω–∞—è)
  # –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã

  ciE <- function(X, Gamma) {
    n <- length(X)
    ciE <- mean(X, na.rm = TRUE)-sd(X, na.rm = TRUE)/sqrt(n)*qt((1+c(Gamma,0,-Gamma))/2,n-1)
    Interval <- cbind(E.Left = ciE[1],E.Right = ciE[3])
    Res <- list(Eo = ciE[2], Interval = Interval)
    return(Res)
  }
  #--------------------------
  # –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏ (–∏–ª–∏ –¥–ª—è –∏—Å—Ç–∏–Ω–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏) –ø–æ –≤—ã–±–æ—Ä–∫–µ
  ciD <- function(X, Gamma) {
    n <- length(X)
    ciD <- sd(X, na.rm = TRUE)^2*(n-1)/qchisq((1+c(Gamma,0,-Gamma))/2,n-1)
    Interval <- cbind(D.Left = ciD[1], D.Right = ciD[3])
    Res <- list(Do = var(X), Interval = Interval)
    return(Res)
  }
  ciE(no_outliers,0.96)
  ciD(no_outliers,0.96)
  #–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã—Ö —á–∞—Å—Ç–æ—Ç
  hist(data) 
  #–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞–∑–º–∞—Ö–∞ ('—è—â–∏–∫ —Å —É—Å–∞–º–∏')
  boxplot(data,ylab='data')

  #–ß–∞—Å—Ç—å 2
  library(stringr)
  data_2 <- c(0)
  data_2 = str_replace_all(data_2, '[;]', ',')
  data_2 = str_replace_all(data_2, '[()]', '')
  data_2
  data_2 <- c()
  n <- matrix(data_2, nrow = 2)
  n = t(n)
  dim(n)
  n
  X = n[, 1]
  Y = n[, 2]
  X
  Y
  #1.2
  cor(X, Y)
  mean(X)
  mean(Y)
  var(X, y = NULL, na.rm = FALSE) #–î–∏—Å–ø–µ—Ä—Å–∏—è (–Ω–µ—Å–º–µ—â–µ–Ω–Ω–∞—è)
  var(Y, y = NULL, na.rm = FALSE) #–î–∏—Å–ø–µ—Ä—Å–∏—è  (–Ω–µ—Å–º–µ—â–µ–Ω–Ω–∞—è)
  #2.1
  #H0:E(X)=E(Y)
  #H1:E(X)<E(Y)
  t.test(Y,X, alternative='greater',paired = TRUE, var.equal = FALSE)
  #H0:E(X)=E(Y)
  #H1:E(X)!=E(Y)
  t.test(Y,X, alternative='two.sided', paired = TRUE, var.equal = FALSE)
  #H0:E(X)=E(Y)
  #H1:E(X)>E(Y)
  t.test(Y,X, alternative='less', paired = TRUE)
  #2.2
  #H0:Var(X)=Var(Y)
  #H1:Var(X)‚â†Var(Y)
  var.test(Y,X, alternative='two.sided')
  #H0:Var(X)=Var(Y)
  #H1:Var(X)>Var(Y)
  var.test(Y,X, alternative='less')
  #H0:Var(X)=Var(Y)
  #H1:Var(X)<Var(Y)
  var.test(Y,X, alternative='greater')

  #–ß–∞—Å—Ç—å 3
  data3 = c()
  data3 = str_replace_all(data3, '[;]', ',')
  data3 = str_replace_all(data3, 'NA', '')
  data3 = str_replace_all(data3, ', ,', ',')
  data3 = str_replace_all(data3, ', ,', ',')
  data3 = c()
  length(data3)
  table(data3)
  summary(data3)
  sort(data3)
  #input sample size and sample proportion
  n <- 154
  p <- 0.3441558
  #calculate margin of error
  margin <- qnorm(0.95)*sqrt(p*(1-p)/n)
  #calculate lower and upper bounds of confidence interval
  low <- p - margin
  low
  high <- p + margin
  high
  library(dplyr)
  table(t)
  barplot(table(data3))
  #3.2
  chisq.test(table(data3), simulate.p.value = TRUE)
  qchisq(0.02,table(data3))
  "
     )
}
