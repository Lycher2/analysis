#' ab for R
#'
#' @param a quadratic coefficient
#' @param b linear coefficient
#' @param c constant
#' @return root
#' @export
ab <- function(a){
  cat(" library(ggplot2)
library(scales)
library(dplyr)
library(ggstatsplot)
library(lmtest)
library(mgcv)
library(itsadug)
library(car)
#Zadacha 1.1
#1)
X <-  c(119.2,123.9,119.8,117,126.2,117.2,118.6,120.2,113,117.8,117.7,123.4,121.1,127.6,122.1,117.6,117.7,108.8)
Y <- c(120.9,118.6,118.1,122.7,116.6,118.6,121.4,119.1,121.9,121.8,119,118.1,122.5,120.3,121.9,121.7,120.1,122.1)
df <- data.frame(x = X, y = Y)
fm<-lm(Y~X)
summary(fm)
coef(fm)
#ğ‘¦ğ‘¡ = ğ‘0 + ğ‘1 âˆ™ ğ‘¥ğ‘¡ + ğœ€ğ‘¡,ğ‘¡ = 1, â€¦ ,18,
#Otsenennaya model v standartnoy forme:
#ğ‘¦ğ‘¡ = 145,14(10,60)âˆ’ 0,21(0,09)âˆ™ ğ‘¥ğ‘¡ + ğœ€Ìƒğ‘¡(1,63),ğ‘¡ = 1, â€¦ ,18
#2)
5.49 > qf(p=.05, df1=1, df2=16, lower.tail=FALSE)
#	Proverka statisticheskoy znachimosti regressii v tselom:
#Proverka statisticheskoy znachimosti koeffitsienta determinatsii sovpadaet s proverkoy znachimosti modeli v tselom
#ğ»0: ğ‘1 = ğ‘2 = â‹¯ = ğ‘ğ‘˜ = 0, gde ğ‘˜ â€“ chislo regressorov, dlya modeli parnoy regressii svoditsya k gipoteze ğ»0: ğ‘1 = 0,
#ğ¹ = 5,49 > ğ¹kr(ğ›¼ = 0,05, ğ‘‘ğ‘“1 = 1, ğ‘‘ğ‘“2 = 16) = 4,49, sledovatelno, net osnovaniy prinyat nulevuyu gipotezu o neznachimosti modeli v tselom, model priznaetsya znachimoy.
#ğ‘…2 = 0,26 - dolya dispersii endogennoy peremennoy, obyasnennaya uravneniem regressii.
#Proverka statisticheskoy znachimosti otsenok koeffitsientov modeli:
#ğ»0: ğ‘0 = 0
#ğ»1: ğ‘0  â‰  0
145.141 / 10.604 > qt(p=.05/2, df=16, lower.tail=FALSE)
#sledovatelno, net osnovaniy prinyat gipotezu o neznachimosti svobodnogo chlena, koeffitsient ğ‘0 priznaetsya znachimym.

abs(-0.20808) / 0.08877 > qt(p=.05/2, df=16, lower.tail=FALSE)
#sledovatelno,	net	osnovaniy	prinyat	gipotezu	o	neznachimosti koeffitsienta ğ‘1, koeffitsient ğ‘1 priznaetsya znachimym.
#3)
#3)	Provedem test Darbina-Uotsona:
durbinWatsonTest(fm)
#ğ»0: ğœŒ = 0,
#dlya ğ‘› = 18, ğ‘˜ = 1 i 5%-nogo urovnya znachimosti znacheniya ğ‘‘ğ¿ i ğ‘‘ğ‘ˆ:
#  ğ‘‘ğ¿ = 1,16, ğ‘‘ğ‘ˆ = 1,39
#ğ·ğ‘Š = 1,91 âˆˆ (ğ‘‘ğ‘¢, 4 âˆ’ ğ‘‘ğ‘¢ ), sledovatelno, net osnovaniy otvergnut gipotezu ob otsutstvii avtokorrelyatsii.
#-	esli ğ·ğ‘Š âˆˆ [0, ğ‘‘ğ¿], to vyborochnyy koeffitsient korrelyatsii sosednikh po nomeru ostatkov regressii ğœŒ > 0, t.e. delaetsya vyvod o nalichii polozhitelnoy avtokorrelyatsii v ostatkakh;
#-	esli ğ·ğ‘Š âˆˆ [4 âˆ’ ğ‘‘ğ¿, 4], to vyborochnyy koeffitsient korrelyatsii sosednikh po nomeru ostatkov regressii ğœŒ < 0, t.e. delaetsya vyvod o nalichii otritsatelnoy avtokorrelyatsii v ostatkakh;

#4) Provedem test Goldfelda-Kvandta: ğ»0: ğœ2 = ğ‘ğ‘œğ‘›ğ‘ ğ‘¡, ğ‘¡ = 1, â€¦ , ğ‘›
#GQ = RSS1/RSS2
#uporyadochit vyborku !
# razdelim vyborku na 3 chasti, uberem iz tsentra 6 znacheniy
gqtest(fm, fraction = 0.3)
#Null (H 0 ) : prisutstvuet gomoskedastichnost.
#Alternativa ( HA ): prisutstvuet geteroskedastichnost.

#5) Adekvatnost
#1.7
X_17 <- c(7,6.2,5.7,5.7,6.7)
Y_17 <- c(2257.3,2541.9,2798.4,3268.6,3657.7)
control_x <- c(3.8)
control_y <- c(10690)
fm<-lm(Y_17~X_17)
summary(fm)
coef(fm)
y_pred = control_x * (-1462.199) + 14725.955
t_crit = 1.67054 # df = 60 q = 0.1
x0_17 <- c(1, 3.8)
x_17 <- c(1, 1, 1, 1, 1)
X_1 = cbind(x_17, X_17)
t(t(x0_17))
stde = 1530
Q_y = sqrt(1 + t(x0_17)%*%solve(t(X_1)%*%X_1)%*%t(t(x0_17))) * stde
Q_y
y_l = y_pred - t_crit*Q_y
y_p = y_pred + t_crit*Q_y
y_l <= control_y 
y_pred<= control_y 
ggscatterstats(
  data = data.frame(x = X, y = Y),
  x = x,
  y = y,
  bf.message = FALSE
)
#dlya sredney otnositelnoy oshibki approksimatsii
predicted<-fm_13$fitted.values
MAE <- function (Obs, Prd, dgt=3){
  ErrorSq = sum(abs(Prd - Obs)/Prd)/length(Obs) * 100
  return(ErrorSq)
}
MAE(Y_13, predicted)
#oshibka aproksimatsii bolshe 7%
#1.5
if(!require(tseries)){install.packages('tseries')}
jb = jarque.bera.test(resid(fm_13))
jb
Xi2 = 5.9914
jb<Xi2
# fiktivnye peremennye 
t <- c(1,2,3,4,5,6,7,8,9,10,11,12,1)
d1 <- c(1,0,0,0,1,0,0,0,1,0,0,0,1,0)
d2 <- c(0,1,0,0,0,1,0,0,0,1,0,0,0,1)
d3 <- c(0,0,1,0,0,0,1,0,0,0,1,0)
fm_2<-lm(Y_2~t+d1+d2+d3)

#exp(1)
#log(x)
#Dopushcheniya MNK:

#Tipy peremennykh na X i Y - kolichestvennye(X,Y), faktornye (X)
#Ne-nulevaya dispersiya
#Net multikollinearnosti
#Prediktory ne korrelirovany s faktorami, ne vklyuchennymi v model
#Gomoksedeksichnost (stabilnost dispersii oshibok)
#Otsutstvie avtokorrelyatsii oshibok (nezavisimost sluchaev)
#Normalno raspredelennye oshibki
#Nezavisimost Y
#Lineynaya zavisimost mezhdu prediktorami i Y

#ğ’	ğ’Œ = ğŸ	ğ’Œ = ğŸ	ğ’Œ = ğŸ‘	ğ’Œ = ğŸ’	ğ’Œ = ğŸ“
# ğ‘‘ğ¿	ğ‘‘ğ‘ˆ	ğ‘‘ğ¿	ğ‘‘ğ‘ˆ	ğ‘‘ğ¿	ğ‘‘ğ‘ˆ	ğ‘‘ğ¿	ğ‘‘ğ‘ˆ	ğ‘‘ğ¿	ğ‘‘ğ‘ˆ
# 6	0,61	1,4								
# 7	0,7	1,36	0,47	1,9						
# 8	0,76	1,33	0,36	1,78	0,37	2,29				
# 9	0,32	1,32	0,63	1,7	0,44	2,13	0,3	2,39		
# 10	0,88	1,32	0,7	1,64	0,53	2,02	0,38	2,41	0,24	2,82
# 11	0,93	1,32	0,66	1,6	0,6	1,93	0,44	2,28	0,32	2,65
# 12	0,97	1,33	0,81	1,58	0,66	1,86	0,51	2,18	0,38	2,51
# 13	1,01	1,34	0,86	1,56	0,72	1,82	0,57	2,09	0,45	2,39
# 14	1,05	1,33	0,91	1,55	0,77	1,78	0,63	2,03	0,51	2,3
# 15	1,08	1,36	0,95	1,54	0,82	1,75	0,69	1,97	0,56	2,21
# 16	1,1	1,37	0,98	1,54	0,86	1,73	0,74	1,93	0,62	2,15
# 17	1,13	1,38	1,02	1,54	0,9	1,71	0,78	1,9	0,67	2,1
# 18	1,16	1,39	1,05	1,53	0,93	1,69	0,82	1,87	0,71	2,06
# 19	1,18	1,4	1,08	1,53	0,97	1,68	0,86	1,85	0,75	2,02
# 20	1,2	1,41	1,1	1,54	1	1,68	0,9	1,83	0,79	1,99
# 21	1,22	1,42	1,13	1,54	1,03	1,67	0,93	1,81	0,83	1,96
# 22	1,24	1,43	1,15	1,54	1,05	1,66	0,96	1,8	0,86	1,94
# 23	1,26	1,44	1,17	1,54	1,08	1,66	0,99	1,79	0,9	1,92
# 24	1,27	1,45	1,19	1,55	1,1	1,66	1,01	1,78	0,93	1,9
# 25	1,29	1,45	1,21	1,55	1,12	1,66	1,04	1,77	0,95	1,89
# 26	1,3	1,46	1,22	1,55	1,14	1,65	1,06	1,76	0,98	1,88
# 27	1,32	1,47	1,24	1,56	1,16	1,65	1,08	1,76	1,01	1,86
# 28	1,33	1,48	1,26	1,56	1,18	1,65	1,1	1,75	1,03	1,85
# 29	1,34	1,48	1,27	1,56	1,2	1,65	1,12	1,74	1,05	1,84
# 30	1,35	1,49	1,28	1,57	1,21	1,65	1,14	1,74	1,07	1,83
# 31	1,36	1,5	1,3	1,57	1,23	1,65	1,16	1,74	1,09	1,83
# 32	1,37	1,5	1,31	1,57	1,24	1,65	1,18	1,73	1,11	1,82
# 33	1,38	1,51	1,32	1,58	1,26	1,65	1,19	1,73	1,13	1,81
# 34	1,39	1,51	1,33	1,58	1,27	1,65	1,21	1,73	1,15	1,81
# 35	1,4	1,52	1,34	1,58	1,28	1,65	1,22	1,73	1,16	1,8
# 36	1,41	1,52	1,35	1,59	1,29	1,65	1,24	1,73	1,18	1,8
# 37	1,42	1,53	1,36	1,59	1,31	1,66	1,25	1,72	1,19	1,8
# 38	1,43	1,54	1,37	1,59	1,32	1,66	1,26	1,72	1,21	1,79
# 39	1,43	1,54	1,38	1,6	1,33	1,66	1,27	1,72	1,22	1,79
# 40	1,44	1,54	1,39	1,6	1,34	1,66	1,29	1,72	1,23	1,79
# 45	1,48	1,57	1,43	1,62	1,38	1,67	1,34	1,72	1,29	1,78
# 47	1,49	1,57	1,44	1,62	1,40	1,67	1,35	1,72	1,31	1,77
# 50	1,5	1,59	1,46	1,63	1,42	1,67	1,38	1,72	1,34	1,77

library(ggplot2)
library(scales)
library(dplyr)
library(ggstatsplot)
library(lmtest)
library(mgcv)
library(itsadug)
library(car)
#Zadacha 1.1
#1)
X <-  c(119.2,123.9,119.8,117,126.2,117.2,118.6,120.2,113,117.8,117.7,123.4,121.1,127.6,122.1,117.6,117.7,108.8)
Y <- c(120.9,118.6,118.1,122.7,116.6,118.6,121.4,119.1,121.9,121.8,119,118.1,122.5,120.3,121.9,121.7,120.1,122.1)
df <- data.frame(x = X, y = Y)
fm<-lm(Y~X)
summary(fm)
coef(fm)
#ğ‘¦ğ‘¡ = ğ‘0 + ğ‘1 âˆ™ ğ‘¥ğ‘¡ + ğœ€ğ‘¡,ğ‘¡ = 1, â€¦ ,18,
#ĞÑ†ĞµĞ½ĞµĞ½Ğ½Ğ°Ñ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ Ğ² ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ğ¾Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğµ:
#ğ‘¦ğ‘¡ = 145,14(10,60)âˆ’ 0,21(0,09)âˆ™ ğ‘¥ğ‘¡ + ğœ€Ìƒğ‘¡(1,63),ğ‘¡ = 1, â€¦ ,18
#2)
5.49 > qf(p=.05, df1=1, df2=16, lower.tail=FALSE)
#	ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸ Ğ² Ñ†ĞµĞ»Ğ¾Ğ¼:
#ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ğ° Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸ ÑĞ¾Ğ²Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚ Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¾Ğ¹ Ğ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ Ğ² Ñ†ĞµĞ»Ğ¾Ğ¼
#ğ»0: ğ‘1 = ğ‘2 = â‹¯ = ğ‘ğ‘˜ = 0, Ğ³Ğ´Ğµ ğ‘˜ â€“ Ñ‡Ğ¸ÑĞ»Ğ¾ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¾Ñ€Ğ¾Ğ², Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ Ğ¿Ğ°Ñ€Ğ½Ğ¾Ğ¹ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸ ÑĞ²Ğ¾Ğ´Ğ¸Ñ‚ÑÑ Ğº Ğ³Ğ¸Ğ¿Ğ¾Ñ‚ĞµĞ·Ğµ ğ»0: ğ‘1 = 0,
#ğ¹ = 5,49 > ğ¹ĞºÑ€(ğ›¼ = 0,05, ğ‘‘ğ‘“1 = 1, ğ‘‘ğ‘“2 = 16) = 4,49, ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾, Ğ½ĞµÑ‚ Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹ Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚ÑŒ Ğ½ÑƒĞ»ĞµĞ²ÑƒÑ Ğ³Ğ¸Ğ¿Ğ¾Ñ‚ĞµĞ·Ñƒ Ğ¾ Ğ½ĞµĞ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ Ğ² Ñ†ĞµĞ»Ğ¾Ğ¼, Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ Ğ¿Ñ€Ğ¸Ğ·Ğ½Ğ°ĞµÑ‚ÑÑ Ğ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ğ¾Ğ¹.
#ğ‘…2 = 0,26 - Ğ´Ğ¾Ğ»Ñ Ğ´Ğ¸ÑĞ¿ĞµÑ€ÑĞ¸Ğ¸ ÑĞ½Ğ´Ğ¾Ğ³ĞµĞ½Ğ½Ğ¾Ğ¹ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾Ğ¹, Ğ¾Ğ±ÑŠÑÑĞ½ĞµĞ½Ğ½Ğ°Ñ ÑƒÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸ĞµĞ¼ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸.
#ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¾Ñ†ĞµĞ½Ğ¾Ğº ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ² Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸:
#ğ»0: ğ‘0 = 0
#ğ»1: ğ‘0  â‰  0
145.141 / 10.604 > qt(p=.05/2, df=16, lower.tail=FALSE)
#ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾, Ğ½ĞµÑ‚ Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹ Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚ÑŒ Ğ³Ğ¸Ğ¿Ğ¾Ñ‚ĞµĞ·Ñƒ Ğ¾ Ğ½ĞµĞ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ñ‡Ğ»ĞµĞ½Ğ°, ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ ğ‘0 Ğ¿Ñ€Ğ¸Ğ·Ğ½Ğ°ĞµÑ‚ÑÑ Ğ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ñ‹Ğ¼.

abs(-0.20808) / 0.08877 > qt(p=.05/2, df=16, lower.tail=FALSE)
#ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾,	Ğ½ĞµÑ‚	Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹	Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚ÑŒ	Ğ³Ğ¸Ğ¿Ğ¾Ñ‚ĞµĞ·Ñƒ	Ğ¾	Ğ½ĞµĞ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ğ° ğ‘1, ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ ğ‘1 Ğ¿Ñ€Ğ¸Ğ·Ğ½Ğ°ĞµÑ‚ÑÑ Ğ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ñ‹Ğ¼.
#3)
#3)	ĞŸÑ€Ğ¾Ğ²ĞµĞ´ĞµĞ¼ Ñ‚ĞµÑÑ‚ Ğ”Ğ°Ñ€Ğ±Ğ¸Ğ½Ğ°-Ğ£Ğ¾Ñ‚ÑĞ¾Ğ½Ğ°:
durbinWatsonTest(fm)
#ğ»0: ğœŒ = 0,
#Ğ´Ğ»Ñ ğ‘› = 18, ğ‘˜ = 1 Ğ¸ 5%-Ğ½Ğ¾Ğ³Ğ¾ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ Ğ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ ğ‘‘ğ¿ Ğ¸ ğ‘‘ğ‘ˆ:
#  ğ‘‘ğ¿ = 1,16, ğ‘‘ğ‘ˆ = 1,39
#ğ·ğ‘Š = 1,91 âˆˆ (ğ‘‘ğ‘¢, 4 âˆ’ ğ‘‘ğ‘¢ ), ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾, Ğ½ĞµÑ‚ Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹ Ğ¾Ñ‚Ğ²ĞµÑ€Ğ³Ğ½ÑƒÑ‚ÑŒ Ğ³Ğ¸Ğ¿Ğ¾Ñ‚ĞµĞ·Ñƒ Ğ¾Ğ± Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ğ¸ Ğ°Ğ²Ñ‚Ğ¾ĞºĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ğ¸.
#-	ĞµÑĞ»Ğ¸ ğ·ğ‘Š âˆˆ [0, ğ‘‘ğ¿], Ñ‚Ğ¾ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ ĞºĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ğ¸ ÑĞ¾ÑĞµĞ´Ğ½Ğ¸Ñ… Ğ¿Ğ¾ Ğ½Ğ¾Ğ¼ĞµÑ€Ñƒ Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ¾Ğ² Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸ ğœŒ > 0, Ñ‚.Ğµ. Ğ´ĞµĞ»Ğ°ĞµÑ‚ÑÑ Ğ²Ñ‹Ğ²Ğ¾Ğ´ Ğ¾ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğ¸ Ğ¿Ğ¾Ğ»Ğ¾Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ğ°Ğ²Ñ‚Ğ¾ĞºĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ğ¸ Ğ² Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ°Ñ…;
#-	ĞµÑĞ»Ğ¸ ğ·ğ‘Š âˆˆ [4 âˆ’ ğ‘‘ğ¿, 4], Ñ‚Ğ¾ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ ĞºĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ğ¸ ÑĞ¾ÑĞµĞ´Ğ½Ğ¸Ñ… Ğ¿Ğ¾ Ğ½Ğ¾Ğ¼ĞµÑ€Ñƒ Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ¾Ğ² Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸ ğœŒ < 0, Ñ‚.Ğµ. Ğ´ĞµĞ»Ğ°ĞµÑ‚ÑÑ Ğ²Ñ‹Ğ²Ğ¾Ğ´ Ğ¾ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğ¸ Ğ¾Ñ‚Ñ€Ğ¸Ñ†Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ğ°Ğ²Ñ‚Ğ¾ĞºĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ğ¸ Ğ² Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ°Ñ…;

#4) ĞŸÑ€Ğ¾Ğ²ĞµĞ´ĞµĞ¼ Ñ‚ĞµÑÑ‚ Ğ“Ğ¾Ğ»Ğ´Ñ„ĞµĞ»Ğ´Ğ°-ĞšĞ²Ğ°Ğ½Ğ´Ñ‚Ğ°: ğ»0: ğœ2 = ğ‘ğ‘œğ‘›ğ‘ ğ‘¡, ğ‘¡ = 1, â€¦ , ğ‘›
#GQ = RSS1/RSS2
#ÑƒĞ¿Ğ¾Ñ€ÑĞ´Ğ¾Ñ‡Ğ¸Ñ‚ÑŒ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºÑƒ !
# Ñ€Ğ°Ğ·Ğ´ĞµĞ»Ğ¸Ğ¼ Ğ²Ñ‹Ğ±Ğ¾Ñ€ĞºÑƒ Ğ½Ğ° 3 Ñ‡Ğ°ÑÑ‚Ğ¸, ÑƒĞ±ĞµÑ€Ñ‘Ğ¼ Ğ¸Ğ· Ñ†ĞµĞ½Ñ‚Ñ€Ğ° 6 Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹
gqtest(fm, fraction = 0.3)
#Null (H 0 ) : Ğ¿Ñ€Ğ¸ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ³Ğ¾Ğ¼Ğ¾ÑĞºĞµĞ´Ğ°ÑÑ‚Ğ¸Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ.
#ĞĞ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ° ( HA ): Ğ¿Ñ€Ğ¸ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ³ĞµÑ‚ĞµÑ€Ğ¾ÑĞºĞµĞ´Ğ°ÑÑ‚Ğ¸Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ.

#5) ĞĞ´ĞµĞºĞ²Ğ°Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ
#1.7
X_17 <- c(7,6.2,5.7,5.7,6.7)
Y_17 <- c(2257.3,2541.9,2798.4,3268.6,3657.7)
control_x <- c(3.8)
control_y <- c(10690)
fm<-lm(Y_17~X_17)
summary(fm)
coef(fm)
y_pred = control_x * (-1462.199) + 14725.955
t_crit = 1.67054 # df = 60 q = 0.1
x0_17 <- c(1, 3.8)
x_17 <- c(1, 1, 1, 1, 1)
X_1 = cbind(x_17, X_17)
t(t(x0_17))
stde = 1530
Q_y = sqrt(1 + t(x0_17)%*%solve(t(X_1)%*%X_1)%*%t(t(x0_17))) * stde
Q_y
y_l = y_pred - t_crit*Q_y
y_p = y_pred + t_crit*Q_y
y_l <= control_y 
y_pred<= control_y 
ggscatterstats(
  data = data.frame(x = X, y = Y),
  x = x,
  y = y,
  bf.message = FALSE
)
#Ğ´Ğ»Ñ ÑÑ€ĞµĞ´Ğ½ĞµĞ¹ Ğ¾Ñ‚Ğ½Ğ¾ÑĞ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ°Ğ¿Ğ¿Ñ€Ğ¾ĞºÑĞ¸Ğ¼Ğ°Ñ†Ğ¸Ğ¸
predicted<-fm_13$fitted.values
MAE <- function (Obs, Prd, dgt=3){
  ErrorSq = sum(abs(Prd - Obs)/Prd)/length(Obs) * 100
  return(ErrorSq)
}
MAE(Y_13, predicted)
#Ğ¾ÑˆĞ¸Ğ±ĞºĞ° Ğ°Ğ¿Ñ€Ğ¾ĞºÑĞ¸Ğ¼Ğ°Ñ†Ğ¸Ğ¸ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ 7%
#1.5
if(!require(tseries)){install.packages('tseries')}
jb = jarque.bera.test(resid(fm_13))
jb
Xi2 = 5.9914
jb<Xi2
# Ñ„Ğ¸ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ 
t <- c(1,2,3,4,5,6,7,8,9,10,11,12,1)
d1 <- c(1,0,0,0,1,0,0,0,1,0,0,0,1,0)
d2 <- c(0,1,0,0,0,1,0,0,0,1,0,0,0,1)
d3 <- c(0,0,1,0,0,0,1,0,0,0,1,0)
fm_2<-lm(Y_2~t+d1+d2+d3)

#exp(1)
#log(x)
#Ğ”Ğ¾Ğ¿ÑƒÑ‰ĞµĞ½Ğ¸Ñ ĞœĞĞš:

#Ğ¢Ğ¸Ğ¿Ñ‹ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ… Ğ½Ğ° X Ğ¸ Y - ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğµ(X,Y), Ñ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ½Ñ‹Ğµ (X)
#ĞĞµ-Ğ½ÑƒĞ»ĞµĞ²Ğ°Ñ Ğ´Ğ¸ÑĞ¿ĞµÑ€ÑĞ¸Ñ
#ĞĞµÑ‚ Ğ¼ÑƒĞ»ÑŒÑ‚Ğ¸ĞºĞ¾Ğ»Ğ»Ğ¸Ğ½ĞµĞ°Ñ€Ğ½Ğ¾ÑÑ‚Ğ¸
#ĞŸÑ€ĞµĞ´Ğ¸ĞºÑ‚Ğ¾Ñ€Ñ‹ Ğ½Ğµ ĞºĞ¾Ñ€Ñ€ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ Ñ Ñ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ°Ğ¼Ğ¸, Ğ½Ğµ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ² Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ
#Ğ“Ğ¾Ğ¼Ğ¾ĞºÑĞµĞ´ĞµĞºÑĞ¸Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ (ÑÑ‚Ğ°Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ´Ğ¸ÑĞ¿ĞµÑ€ÑĞ¸Ğ¸ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº)
#ĞÑ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ğ°Ğ²Ñ‚Ğ¾ĞºĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ğ¸ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº (Ğ½ĞµĞ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ÑŒ ÑĞ»ÑƒÑ‡Ğ°ĞµĞ²)
#ĞĞ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
#ĞĞµĞ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Y
#Ğ›Ğ¸Ğ½ĞµĞ¹Ğ½Ğ°Ñ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ñ€ĞµĞ´Ğ¸ĞºÑ‚Ğ¾Ñ€Ğ°Ğ¼Ğ¸ Ğ¸ Y

#ğ’	ğ’Œ = ğŸ	ğ’Œ = ğŸ	ğ’Œ = ğŸ‘	ğ’Œ = ğŸ’	ğ’Œ = ğŸ“
# ğ‘‘ğ¿	ğ‘‘ğ‘ˆ	ğ‘‘ğ¿	ğ‘‘ğ‘ˆ	ğ‘‘ğ¿	ğ‘‘ğ‘ˆ	ğ‘‘ğ¿	ğ‘‘ğ‘ˆ	ğ‘‘ğ¿	ğ‘‘ğ‘ˆ
# 6	0,61	1,4								
# 7	0,7	1,36	0,47	1,9						
# 8	0,76	1,33	0,36	1,78	0,37	2,29				
# 9	0,32	1,32	0,63	1,7	0,44	2,13	0,3	2,39		
# 10	0,88	1,32	0,7	1,64	0,53	2,02	0,38	2,41	0,24	2,82
# 11	0,93	1,32	0,66	1,6	0,6	1,93	0,44	2,28	0,32	2,65
# 12	0,97	1,33	0,81	1,58	0,66	1,86	0,51	2,18	0,38	2,51
# 13	1,01	1,34	0,86	1,56	0,72	1,82	0,57	2,09	0,45	2,39
# 14	1,05	1,33	0,91	1,55	0,77	1,78	0,63	2,03	0,51	2,3
# 15	1,08	1,36	0,95	1,54	0,82	1,75	0,69	1,97	0,56	2,21
# 16	1,1	1,37	0,98	1,54	0,86	1,73	0,74	1,93	0,62	2,15
# 17	1,13	1,38	1,02	1,54	0,9	1,71	0,78	1,9	0,67	2,1
# 18	1,16	1,39	1,05	1,53	0,93	1,69	0,82	1,87	0,71	2,06
# 19	1,18	1,4	1,08	1,53	0,97	1,68	0,86	1,85	0,75	2,02
# 20	1,2	1,41	1,1	1,54	1	1,68	0,9	1,83	0,79	1,99
# 21	1,22	1,42	1,13	1,54	1,03	1,67	0,93	1,81	0,83	1,96
# 22	1,24	1,43	1,15	1,54	1,05	1,66	0,96	1,8	0,86	1,94
# 23	1,26	1,44	1,17	1,54	1,08	1,66	0,99	1,79	0,9	1,92
# 24	1,27	1,45	1,19	1,55	1,1	1,66	1,01	1,78	0,93	1,9
# 25	1,29	1,45	1,21	1,55	1,12	1,66	1,04	1,77	0,95	1,89
# 26	1,3	1,46	1,22	1,55	1,14	1,65	1,06	1,76	0,98	1,88
# 27	1,32	1,47	1,24	1,56	1,16	1,65	1,08	1,76	1,01	1,86
# 28	1,33	1,48	1,26	1,56	1,18	1,65	1,1	1,75	1,03	1,85
# 29	1,34	1,48	1,27	1,56	1,2	1,65	1,12	1,74	1,05	1,84
# 30	1,35	1,49	1,28	1,57	1,21	1,65	1,14	1,74	1,07	1,83
# 31	1,36	1,5	1,3	1,57	1,23	1,65	1,16	1,74	1,09	1,83
# 32	1,37	1,5	1,31	1,57	1,24	1,65	1,18	1,73	1,11	1,82
# 33	1,38	1,51	1,32	1,58	1,26	1,65	1,19	1,73	1,13	1,81
# 34	1,39	1,51	1,33	1,58	1,27	1,65	1,21	1,73	1,15	1,81
# 35	1,4	1,52	1,34	1,58	1,28	1,65	1,22	1,73	1,16	1,8
# 36	1,41	1,52	1,35	1,59	1,29	1,65	1,24	1,73	1,18	1,8
# 37	1,42	1,53	1,36	1,59	1,31	1,66	1,25	1,72	1,19	1,8
# 38	1,43	1,54	1,37	1,59	1,32	1,66	1,26	1,72	1,21	1,79
# 39	1,43	1,54	1,38	1,6	1,33	1,66	1,27	1,72	1,22	1,79
# 40	1,44	1,54	1,39	1,6	1,34	1,66	1,29	1,72	1,23	1,79
# 45	1,48	1,57	1,43	1,62	1,38	1,67	1,34	1,72	1,29	1,78
# 47	1,49	1,57	1,44	1,62	1,40	1,67	1,35	1,72	1,31	1,77
# 50	1,5	1,59	1,46	1,63	1,42	1,67	1,38	1,72	1,34	1,77
"
     )
}
